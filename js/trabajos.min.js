function AddCliente(){resetForm("formNuevo"),$(".btnModalClientes").attr("id","btnAdd"),$("#modal_title").html("Nuevo cliente"),$("#modalClientes").modal("show")}function editCliente(t){resetForm("formNuevo"),$(".btnModalClientes").attr("id","btnEdit"),$("#modal_title").html("Editar cliente"),$.ajax({url:"routes/routeClientes.php",type:"post",data:{info:t,action:"get"},dataType:"json",beforeSend:function(){showSpinner()},error:function(t){toast1("Error!",t,8e3,"error"),removeSpinner()},success:function(t){if(removeSpinner(),""!=t){$("#id").val(t[0].idcliente),$("#action").val("update"),$("#txt_nombre").val(t[0].nombre),$("#txt_rfc").val(t[0].rfc),$("#txt_calle").val(t[0].calle),$("#txt_noext").val(t[0].noext),$("#txt_int").val(t[0].noint),$("#txt_colonia").val(t[0].colonia),$("#txt_cp").val(t[0].cp),$("#txt_pais").val(t[0].pais),$("#txt_ciudad").val(t[0].ciudad),$("#txt_tel1").val(t[0].tel1),$("#txt_tel2").val(t[0].tel2),$("#txt_correo").val(t[0].ctacorreo),$("#txt_web").val(t[0].sitioweb),$("#txt_estado").val(t[0].estado),$("#txt_municipio").empty(),$("#txt_municipio").append('<option value="0">Seleccione una opción</option>');for(var e=1;e<t.length;e++)t[e].idcliente==t[0].municipio?$("#txt_municipio").append('<option value="'+t[e].idcliente+'" selected>'+t[e].nombre+"</option>"):$("#txt_municipio").append('<option value="'+t[e].idcliente+'">'+t[e].nombre+"</option>");$("#modalClientes").modal("show")}}})}function getClientes(t){$.ajax({url:"routes/routeClientes.php",type:"POST",async:!1,data:{info:t,action:"read"},dataType:"JSON",beforeSend:function(){showSpinner()},error:function(t){console.log(t),toast1("Error!",t,8e3,"error"),removeSpinner()},success:function(t){console.log(t),removeSpinner(),$("#txt_cliente").empty();var e='<option value="0" selected disabled>Seleccione un cliente</option>';if(""!=t)for(var a=0;a<t.length;a++)e+='<option value="'+t[a][0]+'">'+t[a][1]+"</option>";else toast1("Atención","No hay cleintes registrados aún",8e3,"warning");$("#txt_cliente").append(e)}})}function addArea(t){var e,a,n,i,o=!0,l=[];return $(".checksMuns:checked").each(function(){e=$(this).val(),a=$("#labelMun_"+e).html(),n=$("#txt_cantidadMun_"+e).val(),1==$(this).prop("checked")&&"0"!=n&&""!=n?(i={idEdo:t,idMun:e,cantidad:n},l.push(i)):o=!1}),areas[t]=l,o}function calculaDiferencia(){var t=$("#txt_cantidadP2").val(),e=$("#txt_cantidad_total").val(),a=0,n=0;$(".txt_cantidadMun").each(function(){var t=$(this).attr("id");t=t.split("txt_cantidadMun_")[1],$("#ch_"+t).is(":checked")&&(a+=parseInt($(this).val()))}),$.each(areas,function(t,e){for(var a=0;a<e.length;a++)n+=e[a].cantidad});var i=e-n-a;$("#txt_diferencia_total").val(i),$("#txt_sumatoria").val(a),$("#txt_diferencia").val(parseInt(t)-a)}function leaveAStepCallback(t,e){return validateSteps(e.fromStep)}function onFinishCallback(t,e){return!0}function validateSteps(t){switch(t){case 1:step1={txt_cliente:$("#txt_cliente").val(),txt_fecha:$("#txt_fecha").val(),txt_hora:$("#txt_hora").val(),txt_detalles:$("#txt_detalles").val(),select_via:$("#select_via").val(),txt_otro:"Otro"==$("#select_via").val()?$("#txt_otro").val():"-",txt_vigencia:$("#txt_vigencia").val(),txt_periodo:$("#txt_periodo").val(),select_servicio:$("#select_servicio").val(),txt_cantidadP1:$("#txt_cantidadP1").val()};var e=!0;return sumaCantidaTotal=step1.txt_cantidadP1,$("#txt_cantidad_total").val(sumaCantidaTotal),e;case 2:var a=areas,e=!1,n=!1;$.each(a,function(){n=!0});var i=$("#txt_diferencia").val(),o=$("#txt_diferencia_total").val();return 0==i&&0==o?e=!0:($("#txt_diferencia").addClass("invalid"),$("#txt_diferencia_total").addClass("invalid")),e&&n?!0:!1;case 3:return!0;case 4:return!0}}$(document).ready(function(){$("#wizard").smartWizard({onLeaveStep:leaveAStepCallback,onFinish:onFinishCallback}),getClientes(1)});var areas={},edoSelected=$("#txt_estadoT").val(),step1,step2,spet3,sumaCantidaTotal=0,sumaCantidadArea=0,error="Ocurrió un error, intentelo mas tarde o pongase en contacto con el administrador",success="La acción se ralizó con exito",validaCampos="Debe llenar todos los campos para poder guardar";$(document).on("change","#editCliente, #newCliente, #btn_next",function(t){t.preventDefault()}),$(document).on("change","#txt_cliente",function(t){var e=$("#txt_cliente").val();$("#editCliente").attr("onclick","editCliente("+e+")"),$.ajax({url:"routes/routeClientes.php",type:"POST",data:{info:e,action:"get"},dataType:"JSON",beforeSend:function(){showSpinner()},error:function(t){console.log(t),toast1("Error!",t,8e3,"error"),removeSpinner()},success:function(t){removeSpinner();var e=t[0].tel1+" | "+t[0].tel2;$("#p_nombre").html(t[0].nombre),$("#p_rfc").html(t[0].rfc),$("#p_tel").html(e),$("#p_email").html(t[0].ctacorreo)}})}),$(document).on("click",".checksMuns",function(t){calculaDiferencia(),$("#tableContainerMuns, #txt_cantidadP2, #txt_sumatoria").removeClass("invalid");var e=0;$(".checksMuns:checked").each(function(){$(this).prop("checked")&&e++}),e>0?($("#txt_estadoT").attr("disabled","disabled"),$("#btn_nuevaArea").removeAttr("disabled")):($("#btn_nuevaArea").attr("disabled","disabled"),$("#txt_estadoT").removeAttr("disabled"))}),$(document).on("click","#btn_nuevaArea",function(t){var e=edoSelected,a=$("#txt_cantidadP2").val(),n=$("#txt_sumatoria").val(),i=$("#txt_diferencia").val(),o={edo:"No se ha seleccionado un estado",cantidad:"Antes de continuar debe espesificar la cantidad que se utilizara para el estado selecionado",area:"Falta definir la cantidad en algún municipio seleccionado",sumatoria:"La sumatoria de las unidades asignadas a cada municipio no coincide con el total seleccionado para el estado",diferencia:"La diferencia entre las unidades asignadas al estado y las seleccionadas para los municipios siempre debe ser cero. Por favor revise de nuevo."};null==e?($("#txt_estadoT").addClass("invalid"),customAlert("Atención!",o.edo)):"0"==a||""==a?($("#txt_cantidadP2").addClass("invalid"),customAlert("Atención!",o.cantidad)):addArea(e)?a!=n?($("#txt_sumatoria").addClass("invalid"),$("#txt_cantidadP2").addClass("invalid"),customAlert("Atención!",o.sumatoria)):"0"!=i?($("#txt_diferencia").addClass("invalid"),customAlert("Atención!",o.diferencia)):$("#txt_estadoT").removeAttr("disabled"):($("#tableContainerMuns").addClass("invalid"),customAlert("Atención!",o.area))}),$(document).on("keyup","#txt_cantidadP2, .txt_cantidadMun",function(t){""==$(this).val()&&$(this).val(0);var e=$(this).val();2==e.length&&(e=e.split(""),e="0"==e[0]?e[1]:e[0]+e[1],$(this).val(e)),calculaDiferencia()}),$(document).on("change","#txt_estadoT",function(t){edoSelected=$("#txt_estadoT").val(),$.ajax({url:"routes/routeDomgeo.php",type:"POST",data:{info:edoSelected,action:"mun"},dataType:"JSON",beforeSend:function(){showSpinner()},error:function(t){console.log(t),toast1("Error!",t,8e3,"error"),removeSpinner()},success:function(t){if(console.log(t),removeSpinner(),$("#tbody2").empty(),""!=t){for(var e="",a=0;a<t.length;a++)e+='<tr>  <td style="width: 2%;padding-left: 15px;">    <div class="checkbox">      <label>        <input type="checkbox" id="ch_'+t[a].cveMpo+'" class="checksMuns" value="'+t[a].cveMpo+'">      </label>    </div>  </td>  <td style="width: 73%">    <center>      <label id="labelMun_'+t[a].cveMpo+'" style="margin-top: 15px;">			'+t[a].nomMpo+'      </label>    </center>  </td>  <td>    <input type="text" id="txt_cantidadMun_'+t[a].cveMpo+'" class="form-control txt_cantidadMun" value="0" style="margin-top: 5px;">  </td></tr>';$("#tbody2").append(e),$.each(areas,function(t,e){if(t==edoSelected)for(var a=0;a<e.length;a++){var n=e[a].idMun,i=e[a].cantidad;$("#ch_"+n).prop("checked","checked"),$("#txt_cantidadMun_"+n).val(i)}})}}})}),$(document).on("keyup",".txtFormStep1",function(t){""!=$(this).val()&&$(this).removeClass("invalid")}),$(document).on("change",".txtFormStep1",function(t){""!=$(this).val()&&$(this).removeClass("invalid")}),$(document).on("change",".selectFormStep1",function(t){null!=$(this).val()&&$(this).removeClass("invalid")}),$(document).on("keyup",".txtFormStep2",function(t){"0"!=$(this).val()&&""!=$(this).val()&&$(this).removeClass("invalid")}),$(document).on("keyup",".txt_cantidadMun",function(t){"0"!=$(this).val()&&""!=$(this).val()&&$("#tableContainerMuns, #txt_cantidadP2, #txt_sumatoria").removeClass("invalid")}),$(document).on("change",".selectFormStep2",function(t){null!=$(this).val()&&$(this).removeClass("invalid")}),$(document).on("click","#btn_nuevo",function(t){t.preventDefault(),$("#modalTrabajos").modal("show")}),$(document).on("click","#btnAdd, #btnEdit",function(){if(""!=$("#txt_nombre").val()&&""!=$("#txt_rfc").val()&&""!=$("#txt_calle").val()&&""!=$("#txt_noext").val()&&""!=$("#txt_colonia").val()&&""!=$("#txt_cp").val()&&""!=$("#txt_pais").val()&&""!=$("#txt_estado").val()&&""!=$("#txt_ciudad").val()&&""!=$("#txt_municipio").val()&&""!=$("#txt_tel1").val()&&""!=$("#txt_correo").val()&&""!=$("#txt_web").val()){$.ajax({url:"routes/routeClientes.php",type:"post",data:serializeForm("formNuevo"),dataType:"json",beforeSend:function(){showSpinner()},error:function(t){toast1("Error!",t,8e3,"error"),removeSpinner()},success:function(t){removeSpinner(),1==t?($("#modalClientes").modal("hide"),toast1("Felicidades!",success,8e3,"success")):toast1("Error!",error,8e3,"error"),showClientes()}});var t=$("#txt_cliente").val();getClientes(1),"btnEdit"==$(this).attr("id")&&($("#txt_cliente").val(t),$("#txt_cliente").trigger("change"))}else customAlert("Atención!",validaCampos)}),$(document).on("change","#select_via",function(t){"Otro"==$(this).val()?$("#div_txt_otro").slideDown():$("#div_txt_otro").slideUp()});